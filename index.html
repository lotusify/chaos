<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<title>ĐAU MẮT VỪA PHẢI</title>
<style>
  * { box-sizing: border-box; }
  html, body {
    height: 100%; margin: 0; overflow: hidden;
    background: #000; font-family: Arial, Helvetica, sans-serif;
  }

  /* --- Nền strobe --- */
  body.strobe {
    animation: bgStrobe 700ms steps(1,end) infinite;
  }
  @keyframes bgStrobe {
    0%   { background: #000; }
    25%  { background: #ff00ff; }  /* magenta */
    50%  { background: #00ffff; }  /* cyan */
    75%  { background: #ffff00; }  /* yellow */
    100% { background: #000; }
  }

  /* Bảng nội dung */
  table {
    position: absolute; top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    width: 70vw; color: #fff;
    border: 2px solid #fff;
    z-index: 2;
    animation: hueSpin 1.2s linear infinite, shake 180ms infinite;
  }
  td, th { border: 2px solid #fff; padding: 10px; }

  @keyframes hueSpin { to { filter: hue-rotate(360deg) contrast(1.4) saturate(1.8); } }
  @keyframes shake {
    0% { transform: translate(-50%, -50%) translate(0,0); }
    50% { transform: translate(-50%, -50%) translate(2px,-2px); }
    100% { transform: translate(-50%, -50%) translate(0,0); }
  }

  /* Chữ nhấp nháy */
  .char {
    position: absolute;
    font-size: 2vw;
    font-weight: bold;
    color: #fff;
    text-shadow: 2px 2px #000;
    animation: charFlicker 0.4s infinite alternate;
  }
  @keyframes charFlicker {
    0% { transform: scale(1) rotate(0deg); opacity: 1; color: #fff; }
    100% { transform: scale(1.3) rotate(10deg); opacity: 0.6; color: #ff0; }
  }

  /* Rickroll bay */
  .rickroll-float {
    position: fixed;
    width: 220px; height: 124px;
    border: 3px solid #fff;
    border-radius: 10px;
    overflow: hidden;
    will-change: transform;
    z-index: 99999;
    pointer-events: none;
    background: #000;
    box-shadow: 0 0 12px rgba(255,255,255,.8);
  }
  .rickroll-float video {
    width: 100%; height: 100%; object-fit: cover; display: block;
  }

  /* Nút điều khiển */
  .ctrl {
    position: fixed; right: 10px; top: 10px;
    z-index: 100000;
    background: #fff; color: #000; border: none; border-radius: 8px;
    padding: 8px 12px; font-weight: 700; cursor: pointer;
  }
</style>
</head>
<body class="strobe">
  <button class="ctrl" id="toggle">PAUSE EFFECTS</button>

  <table>
    <tr><td colspan="2" id="cell-container"></td></tr>
  </table>

  <script>
    /* ============ CẤU HÌNH ============ */
    const NUM_FLOATERS = 8;               // Rickroll
    const SPEED_MIN = 120, SPEED_MAX = 280;
    const CHAR_COUNT = 50;                // số chữ bay
    const CHAR_SPEED = 60;                // tốc độ chữ
    const TEXT_CHANGE_INTERVAL = 400;     // đổi ký tự liên tục
    /* ================================== */

    const rand = (a,b) => Math.random()*(b-a)+a;
    const sign = () => Math.random()<.5 ? -1 : 1;

    let running = true;

    /* ============ TẠO CHỮ BAY ============ */
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@#$%^&*()';
    const body = document.body;
    const flyingChars = [];

    for (let i = 0; i < CHAR_COUNT; i++) {
      const el = document.createElement('div');
      el.className = 'char';
      el.textContent = chars[Math.floor(Math.random()*chars.length)];
      body.appendChild(el);

      flyingChars.push({
        el,
        x: rand(0, innerWidth),
        y: rand(0, innerHeight),
        vx: sign()*rand(CHAR_SPEED/2, CHAR_SPEED),
        vy: sign()*rand(CHAR_SPEED/2, CHAR_SPEED)
      });
    }

    function updateCharText() {
      for (const fc of flyingChars) {
        fc.el.textContent = chars[Math.floor(Math.random()*chars.length)];
      }
    }
    setInterval(updateCharText, TEXT_CHANGE_INTERVAL);

    /* ============ RICKROLL FLOAT ============ */
    const floaters = [];
    function addFloater() {
      const el = document.createElement('div');
      el.className = 'rickroll-float';
      const vid = document.createElement('video');
      vid.src = 'secret.mp4';
      vid.autoplay = true; vid.loop = true; vid.muted = true; vid.playsInline = true;
      vid.playbackRate = rand(0.9, 1.3);
      el.appendChild(vid);
      body.appendChild(el);

      const w = 220, h = 124;
      floaters.push({
        el, w, h,
        x: rand(0, innerWidth - w),
        y: rand(0, innerHeight - h),
        vx: sign()*rand(SPEED_MIN, SPEED_MAX),
        vy: sign()*rand(SPEED_MIN, SPEED_MAX)
      });
    }
    for (let i = 0; i < NUM_FLOATERS; i++) addFloater();

    /* ============ ANIMATION LOOP ============ */
    let last = performance.now();
    function loop(now) {
      if (!running) { requestAnimationFrame(loop); return; }
      const dt = Math.min(0.033, (now - last) / 1000);
      last = now;

      const W = innerWidth, H = innerHeight;

      // Cập nhật chữ bay
      for (const fc of flyingChars) {
        fc.x += fc.vx * dt;
        fc.y += fc.vy * dt;

        if (fc.x <= 0 || fc.x >= W) fc.vx *= -1;
        if (fc.y <= 0 || fc.y >= H) fc.vy *= -1;

        fc.el.style.left = fc.x + 'px';
        fc.el.style.top = fc.y + 'px';
      }

      // Cập nhật Rickroll
      for (const f of floaters) {
        f.x += f.vx * dt;
        f.y += f.vy * dt;

        if (f.x <= 0) { f.x = 0; f.vx = Math.abs(f.vx); }
        if (f.x + f.w >= W) { f.x = W - f.w; f.vx = -Math.abs(f.vx); }
        if (f.y <= 0) { f.y = 0; f.vy = Math.abs(f.vy); }
        if (f.y + f.h >= H) { f.y = H - f.h; f.vy = -Math.abs(f.vy); }

        f.el.style.transform = `translate(${f.x}px, ${f.y}px)`;
      }

      requestAnimationFrame(loop);
    }
    requestAnimationFrame(loop);

    /* ============ NÚT TẮT HIỆU ỨNG ============ */
    const btn = document.getElementById('toggle');
    btn.addEventListener('click', () => {
      running = !running;
      document.body.classList.toggle('strobe');
      btn.textContent = running ? 'PAUSE EFFECTS' : 'RESUME EFFECTS';
    });

    /* ============ RESIZE ============ */
    window.addEventListener('resize', () => {
      for (const f of floaters) {
        if (f.x + f.w > innerWidth) f.x = innerWidth - f.w;
        if (f.y + f.h > innerHeight) f.y = innerHeight - f.h;
      }
      for (const fc of flyingChars) {
        if (fc.x > innerWidth) fc.x = innerWidth - 10;
        if (fc.y > innerHeight) fc.y = innerHeight - 10;
      }
    });
  </script>
</body>
</html>
